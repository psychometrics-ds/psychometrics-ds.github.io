{%- assign _excerpt_truncate = include.excerpt_truncate | default: 350 -%}
{%- assign _excerpt_type = include.excerpt_type -%}
{%- include snippets/get-locale-string.html key='READMORE' -%}
{%- assign _locale_readmore = __return -%}

{%- assign _sorted_list = include.articles | sort: 'date' -%}
{%- if include.group_by == 'year' or include.reverse -%}
  {%- assign _sorted_list = _sorted_list | reverse -%}
{%- endif -%}

{%- if include.type == 'item' -%}
<div class="article-list items items--divided">
{%- elsif include.type == 'brief' -%}
<div class="article-list items">
{%- elsif include.type == 'grid' -%}
  {%- if include.size == 'sm' -%}
  <div class="article-list grid grid--sm grid--p-3">
  {%- else -%}
  <div class="article-list grid grid--p-3">
  {%- endif -%}
{%- endif -%}

  {%- if include.group_by == 'year' -%}
    {%- assign _date = '' -%}
    {%- for _article in _sorted_list -%}
      {%- assign _currentdate = _article.date | date: '%Y' -%}
      {%- if _currentdate != _date -%}
        {%- unless forloop.first -%}</ul></section>{%- endunless -%}
        <section><h2 class="article-list__group-header">{{ _currentdate }}</h2><ul class="items">
        {%- assign _date = _currentdate -%}
      {%- endif -%}
      {%- include snippets/prepend-baseurl.html path=_article.url -%}
      {%- assign _article_url = __return -%}
      {%- if _article.cover -%}
        {%- include snippets/get-nav-url.html path=_article.cover -%}
        {%- assign _article_cover = __return -%}
      {%- endif -%}
      <li class="item" itemscope itemtype="http://schema.org/BlogPosting">
        <div class="item__content">
          {%- if include.show_info -%}
            <span class="item__meta">{{ _article.date | date: '%B %d, %Y' }}</span>
          {%- endif -%}
          <a itemprop="headline" class="item__header" href="{{ _article_url }}">{{ _article.title }}</a>
          {%- if _article.excerpt and include.show_excerpt -%}
            <div class="article__content" itemprop="description articleBody">
              {%- if _excerpt_type == 'html' -%}
                {{ _article.excerpt }}
              {%- else -%}
                {{ _article.excerpt | strip_html | strip | truncate: _excerpt_truncate }}
              {%- endif -%}
            </div>
          {%- endif -%}
          {%- if include.show_readmore -%}
            <p><a href="{{ _article_url }}">{{ _locale_readmore }}</a></p>
          {%- endif -%}
        </div>
      </li>
    {%- endfor -%}
    </ul></section>
  {%- else -%}
    {%- for _article in _sorted_list -%}
      {%- include snippets/prepend-baseurl.html path=_article.url -%}
      {%- assign _article_url = __return -%}
      {%- if _article.cover -%}
        {%- include snippets/get-nav-url.html path=_article.cover -%}
        {%- assign _article_cover = __return -%}
      {%- endif -%}
      <li class="item" itemscope itemtype="http://schema.org/BlogPosting">
        <div class="item__content">
          {%- if include.show_info -%}
            <span class="item__meta">{{ _article.date | date: '%B %d, %Y' }}</span>
          {%- endif -%}
          <a itemprop="headline" class="item__header" href="{{ _article_url }}">{{ _article.title }}</a>
          {%- if _article.excerpt and include.show_excerpt -%}
            <div class="article__content" itemprop="description articleBody">
              {%- if _excerpt_type == 'html' -%}
                {{ _article.excerpt }}
              {%- else -%}
                {{ _article.excerpt | strip_html | strip | truncate: _excerpt_truncate }}
              {%- endif -%}
            </div>
          {%- endif -%}
          {%- if include.show_readmore -%}
            <p><a href="{{ _article_url }}">{{ _locale_readmore }}</a></p>
          {%- endif -%}
        </div>
      </li>
    {%- endfor -%}
  {%- endif -%}
</div>